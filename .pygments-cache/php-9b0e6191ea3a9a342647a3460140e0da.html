<div class="highlight"><pre><span class="nx">header</span><span class="p">(</span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]){</span>

    <span class="k">include_once</span> <span class="s2">&quot;../class/ImageGenerate.php&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">])){</span>
        <span class="nv">$teste</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">imageGenerate</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]);</span>
        <span class="nv">$width</span> <span class="o">=</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]))</span><span class="o">?</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="mi">160</span><span class="p">;</span>
        <span class="nv">$height</span> <span class="o">=</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]))</span><span class="o">?</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="mi">160</span><span class="p">;</span>
        <span class="nv">$teste</span><span class="o">-&gt;</span><span class="na">resize</span><span class="p">(</span><span class="nv">$width</span><span class="p">,</span><span class="nv">$height</span><span class="p">)</span>
              <span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="s1">&#39;../image/destination/&#39;</span><span class="o">.</span><span class="nb">end</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">])));</span>
        <span class="k">echo</span> <span class="nb">json_encode</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;status&#39;</span>    <span class="o">=&gt;</span>  <span class="s1">&#39;OK&#39;</span><span class="p">,</span>
            <span class="s1">&#39;msg&#39;</span>       <span class="o">=&gt;</span>   <span class="nx">utf8_encode</span><span class="p">(</span><span class="s1">&#39;Image save on &#39;</span><span class="o">.</span><span class="s1">&#39;image/destination/&#39;</span><span class="o">.</span><span class="nb">end</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">])))</span>
        <span class="p">),</span> <span class="k">true</span><span class="p">);</span>

    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="nb">json_encode</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;status&#39;</span>    <span class="o">=&gt;</span>  <span class="s1">&#39;ERROR&#39;</span><span class="p">,</span>
            <span class="s1">&#39;msg&#39;</span>       <span class="o">=&gt;</span>  <span class="nx">utf8_encode</span><span class="p">(</span><span class="s1">&#39;picture does not exist&#39;</span><span class="p">)</span>
        <span class="p">),</span> <span class="k">true</span><span class="p">);</span>
    <span class="p">}</span>


<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nb">json_encode</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;status&#39;</span>    <span class="o">=&gt;</span>  <span class="s1">&#39;ERROR&#39;</span><span class="p">,</span>
        <span class="s1">&#39;msg&#39;</span>       <span class="o">=&gt;</span>  <span class="nx">utf8_encode</span><span class="p">(</span><span class="s1">&#39;not sent parameter&#39;</span><span class="p">)</span>
    <span class="p">),</span> <span class="k">true</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>